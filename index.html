<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>MeFan - Independent Left/Right Containers</title>
  <style>
    /* ========== Reset & 基础 ========== */
    * {
      margin: 0; padding: 0; box-sizing: border-box;
    }
    body {
      font-family: sans-serif;
      line-height: 1.5;
      padding-top: 60px; /* 模拟顶部导航 */
      background: #fff; color: #333;
    }
    .header {
      position: fixed; top:0; left:0; width:100%; height:60px;
      background: linear-gradient(to right, #DEEFFF, #B2D8FF);
      z-index:3000; display:flex; align-items:center; padding:0 20px;
    }
    .header h1 { font-size:1.2rem; color:#444; }

    /* ========== 模拟区块: section2-highlights ========== */
    .section2-highlights {
      position: relative;
      width: 80%; max-width: 1000px;
      margin: 50px auto; padding: 20px;
      background: #f9f9f9; border: 1px solid #ddd; text-align: center;
    }
    .section2-content {
      width: 100%; height: 300px; background: #eee;
      display: flex; align-items: center; justify-content: center;
      font-size:1.5rem; color:#666;
    }

    /* ========== 左右容器(独立) ========== */
    /* 绝对定位在 .section2-highlights 内部 (position: relative) */
    #leftPill, #rightCircle {
      position: absolute;
      top: 50%; /* 先让它们都以中线为基准 */
      left: 50%;
      transform: translate(-50%, -50%) scale(0); /* 初始缩小隐藏 */
      opacity: 0;
      transition: transform 0.5s ease, opacity 0.5s ease;
      z-index: 9999;
      pointer-events: auto; /* 可点击 */
    }

    /* 左胶囊内部样式 */
    #leftPill {
      width: 140px; height: 50px;
      border: 2px solid #007aff;
      border-radius: 30px;
      background: #f2f2f2;
      display: flex; align-items: center; justify-content: space-evenly;
      gap: 6px; padding: 0 12px;
    }
    .progress-bar {
      width: 40px; height: 8px; background: #666; border-radius: 4px;
    }
    .dot {
      width:6px; height:6px; background:#666; border-radius:50%;
    }

    /* 右播放圆 */
    #rightCircle {
      width: 50px; height: 50px;
      border: 2px solid #007aff; border-radius: 50%;
      background: #fff;
      display: flex; align-items:center; justify-content:center;
      cursor: pointer;
    }
    .play-icon {
      width:0; height:0;
      border-top:6px solid transparent; border-bottom:6px solid transparent;
      border-left:10px solid #333; margin-left:2px;
    }

    /* ========== 通过切换类 parted/merged/hidden 让他们移动/缩放 ========== */
    /* hidden: 不可见 => scale(0), opacity:0 */
    .hidden {
      transform: translate(-50%, -50%) scale(0);
      opacity: 0;
      pointer-events: none;
    }
    /* merged: 两者都重叠在中心 => scale(1), 不偏移X */
    .merged {
      transform: translate(-50%, -50%) scale(1);
      opacity: 1;
    }
    /* parted: 左的往左移, 右的往右移 => 形成间距 */
    /* 例如 left: transformX(-120px), right: transformX(+120px) */
    .left-parted {
      transform: translate(-50%, -50%) translateX(-80px) scale(1);
      /* 你可调 -80px => 间距大小 */
      opacity: 1;
    }
    .right-parted {
      transform: translate(-50%, -50%) translateX(80px) scale(1);
      opacity: 1;
    }

  </style>
</head>
<body>
  <div class="header">
    <h1>Independent Left & Right Containers Demo</h1>
  </div>

  <!-- 模拟上方内容 -->
  <div style="height:400px; background:#fff; padding:20px;">
    <p>Scroll down to see section2 highlights area with left & right containers parted or merged.</p>
  </div>

  <!-- section2-highlights -->
  <section id="section2-highlights" class="section2-highlights">
    <h2>Demo for Splitting Buttons (No Outer Container)</h2>
    <div class="section2-content">
      <p>Slide Content / Carousel ...</p>
    </div>

    <!-- 左胶囊(独立容器) -->
    <div id="leftPill" class="hidden">
      <div class="progress-bar"></div>
      <div class="dot"></div>
      <div class="dot"></div>
      <div class="dot"></div>
      <div class="dot"></div>
    </div>
    <!-- 右圆形播放按钮(独立容器) -->
    <div id="rightCircle" class="hidden">
      <div class="play-icon"></div>
    </div>
  </section>

  <!-- 其余内容... -->
  <div style="height:1000px; background:#fafafa;">
    <p style="padding:20px;">More content below ... keep scrolling ...</p>
  </div>

  <script>
  document.addEventListener('DOMContentLoaded', function(){
    const section2 = document.getElementById('section2-highlights');
    const leftPill = document.getElementById('leftPill');
    const rightCircle = document.getElementById('rightCircle');

    let parted = false; // 标记是否“分裂”状态

    // 简单示例点击事件
    leftPill.addEventListener('click', (e)=>{
      e.stopPropagation();
      alert("点击到左胶囊容器!");
    });
    rightCircle.addEventListener('click', (e)=>{
      e.stopPropagation();
      alert("点击到右播放圆容器!");
    });

    // 监听滚动, 根据 rect.bottom-viewport <= -180 => parted, 否则 merged
    window.addEventListener('scroll', onScroll);

    function onScroll(){
      const rect = section2.getBoundingClientRect();
      const distance = rect.bottom - window.innerHeight;
      if(distance <= -180) {
        if(!parted){
          showParted(); // 进入分裂状态
        }
      } else {
        if(parted){
          hideParted(); // 回到合并or隐藏状态
        }
      }
    }

    function showParted(){
      parted = true;
      // 让左右从 hidden => parted
      leftPill.classList.remove('hidden', 'merged');
      leftPill.classList.add('left-parted');
      rightCircle.classList.remove('hidden', 'merged');
      rightCircle.classList.add('right-parted');
    }

    function hideParted(){
      parted = false;
      // 先合并 (merged) => 再变 hidden
      // 你也可一步到位 => hidden, 这里示例：先 merged => setTimeout => hidden
      leftPill.classList.remove('left-parted');
      rightCircle.classList.remove('right-parted');
      leftPill.classList.add('merged');
      rightCircle.classList.add('merged');

      // 等 merged 动画结束后 => hidden
      setTimeout(()=>{
        leftPill.classList.remove('merged');
        rightCircle.classList.remove('merged');
        leftPill.classList.add('hidden');
        rightCircle.classList.add('hidden');
      }, 500); // 与transition时长匹配
    }
  });
  </script>
</body>
</html>
