<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>Independent Left/Right Buttons - No Outer Container</title>
  <style>
    /* ======== 基础重置 & 布局 ======== */
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family: sans-serif;
      line-height: 1.5;
      padding-top: 60px; /* 模拟导航区 */
      background: #fff; color:#333;
    }
    .header {
      position:fixed; top:0; left:0; width:100%; height:60px;
      background: linear-gradient(to right,#DEEFFF,#B2D8FF);
      display:flex; align-items:center; padding:0 20px;
      z-index:3000;
    }
    .header h1 { font-size:1.2rem; color:#444; }

    /* ======== 模拟 section2-highlights ======== */
    .section2-highlights {
      position: relative; /* 让绝对定位的按钮参照 */
      width: 80%; max-width:1000px;
      margin:40px auto; padding:20px;
      border:1px solid #ddd; background:#f9f9f9;
      text-align:center;
    }
    .carousel-content {
      width:100%; height:300px; background:#eee;
      display:flex; align-items:center; justify-content:center;
      font-size:1.5rem; color:#666;
    }

    /* ======== 左胶囊 & 右播放 - 完全独立 ======== */
    /* 绝对定位在 .section2-highlights 里；初始隐藏 (scale(0)) */
    .btn-base {
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%,-50%) scale(0);
      opacity: 0;
      transition: transform 0.4s ease, opacity 0.4s ease;
      z-index: 9999; 
      pointer-events: auto; /* 可点击 */
    }
    /* 当显示并且合并在中心时 => scale(1) & 不偏移X */
    .btn-merged {
      transform: translate(-50%,-50%) scale(1);
      opacity: 1;
    }
    /* 当分裂时，左胶囊向左移80px, 右圆向右移80px */
    .btn-left-parted {
      transform: translate(-50%,-50%) translateX(-80px) scale(1);
      opacity: 1;
    }
    .btn-right-parted {
      transform: translate(-50%,-50%) translateX(80px) scale(1);
      opacity: 1;
    }
    /* 当隐藏时 => scale(0), opacity:0 */
    .btn-hidden {
      transform: translate(-50%,-50%) scale(0);
      opacity: 0;
      pointer-events: none;
    }

    /* ======== 左胶囊自身UI ======== */
    #leftPill {
      width: 140px; height:50px;
      display:flex; align-items:center; justify-content:space-evenly;
      border: 2px solid #007aff; border-radius:30px;
      background: #f2f2f2;
      gap:6px; padding:0 10px;
    }
    .progress-bar {
      width:40px; height:8px; background:#666; border-radius:4px;
    }
    .dot { width:6px; height:6px; background:#666; border-radius:50%; }

    /* ======== 右播放圆自身UI ======== */
    #rightCircle {
      width:50px; height:50px;
      border:2px solid #007aff; border-radius:50%;
      background:#fff;
      display:flex; align-items:center; justify-content:center;
      cursor:pointer;
    }
    .play-icon {
      width:0; height:0;
      border-top:6px solid transparent; border-bottom:6px solid transparent;
      border-left:10px solid #333; margin-left:2px;
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>Independent L/R Buttons Demo</h1>
  </div>

  <!-- 模拟页面上方空白 -->
  <div style="height:400px; background:#fff; padding:20px;">
    <p>Scroll down to see the highlight area where left & right appear parted or merged.</p>
  </div>

  <!-- section2-highlights -->
  <section id="section2-highlights" class="section2-highlights">
    <h2>Highlights Section</h2>
    <div class="carousel-content">
      <p>Carousel Slides ...</p>
    </div>

    <!-- 左胶囊 -->
    <div id="leftPill" class="btn-base btn-hidden">
      <div class="progress-bar"></div>
      <div class="dot"></div>
      <div class="dot"></div>
      <div class="dot"></div>
      <div class="dot"></div>
    </div>
    <!-- 右播放圆 -->
    <div id="rightCircle" class="btn-base btn-hidden">
      <div class="play-icon"></div>
    </div>
  </section>

  <!-- 其余内容拉长页面 -->
  <div style="height:1000px; background:#fafafa; padding:20px;">
    <h2>More content below ...</h2>
  </div>

  <script>
  document.addEventListener('DOMContentLoaded', function(){
    const section2 = document.getElementById('section2-highlights');
    const leftPill = document.getElementById('leftPill');
    const rightCircle = document.getElementById('rightCircle');

    let parted = false; // 是否分裂
    let visible = false; // 是否可见

    // 点击事件示例
    leftPill.addEventListener('click', ()=> alert("点击左胶囊！"));
    rightCircle.addEventListener('click',()=> alert("点击右播放圆按钮！"));

    window.addEventListener('scroll', onScroll);

    function onScroll(){
      const rect = section2.getBoundingClientRect();
      const distance = rect.bottom - window.innerHeight;
      // 当滚动到区块底部 <= -180 => parted(分裂)
      if(distance <= -180){
        // 显示并 parted
        if(!visible){
          showMerged(); // 先合并再 parted, 你也可直接 parted
        }
        if(!parted){
          setTimeout(()=> doParted(), 400); 
          // 给一点时间执行 showMerged 后再 parted
        }
      } else {
        // 合并并隐藏
        if(visible || parted){
          hideAll();
        }
      }
    }

    // 先短暂合并到中心, 再 parted
    function showMerged(){
      visible = true;
      parted = false;
      // 移除 hidden => merged
      leftPill.classList.remove('btn-hidden','btn-left-parted');
      rightCircle.classList.remove('btn-hidden','btn-right-parted');
      leftPill.classList.add('btn-merged');
      rightCircle.classList.add('btn-merged');
    }

    function doParted(){
      parted = true;
      // remove merged => parted
      leftPill.classList.remove('btn-merged');
      leftPill.classList.add('btn-left-parted');
      rightCircle.classList.remove('btn-merged');
      rightCircle.classList.add('btn-right-parted');
    }

    function hideAll(){
      parted = false;
      visible = false;
      // 回到合并态
      leftPill.classList.remove('btn-left-parted');
      rightCircle.classList.remove('btn-right-parted');
      leftPill.classList.add('btn-merged');
      rightCircle.classList.add('btn-merged');

      // 再过一点时间 => hidden
      setTimeout(()=>{
        leftPill.classList.remove('btn-merged');
        rightCircle.classList.remove('btn-merged');
        leftPill.classList.add('btn-hidden');
        rightCircle.classList.add('btn-hidden');
      }, 400);
    }
  });
  </script>
</body>
</html>
